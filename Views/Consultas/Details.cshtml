@model HealthWellbeing.Models.Consulta

@{
    ViewData["Title"] = "Detalhes da Consulta";

    var estado = Model.Estado;

    string badgeClass;
    if (estado == "Cancelada")
    {
        badgeClass = "badge bg-danger";
    }
    else if (estado == "Expirada")
    {
        badgeClass = "badge bg-secondary";
    }
    else if (estado == "Hoje")
    {
        badgeClass = "badge bg-warning text-dark";
    }
    else
    {
        badgeClass = "badge bg-success";
    }
}

<div class="container py-5">
    <div class="card shadow-lg border-0 rounded-4 overflow-hidden">
        <div class="card-header bg-primary text-white d-flex align-items-center justify-content-between">
            <h2 class="mb-0">
                <i class="bi bi-file-earmark-text me-2"></i> Detalhes da Consulta
            </h2>
            <span class="@badgeClass fs-6 px-3 py-2">@estado</span>
        </div>

        <div class="card-body bg-light px-5 py-4">
            <dl class="row mb-0">
                <dt class="col-sm-4 fw-semibold text-secondary">Data de Marcação</dt>
                <dd class="col-sm-8">
                    @Model.DataMarcacao.ToString("dd/MM/yyyy HH:mm")
                </dd>

                <dt class="col-sm-4 fw-semibold text-secondary">Data da Consulta</dt>
                <dd class="col-sm-8">
                    @Model.DataConsulta.ToString("dd/MM/yyyy HH:mm")
                </dd>

                <dt class="col-sm-4 fw-semibold text-secondary">Hora de Início</dt>
                <dd class="col-sm-8">
                    @Model.HoraInicio.ToString("HH\\:mm")
                </dd>

                <dt class="col-sm-4 fw-semibold text-secondary">Hora de Fim</dt>
                <dd class="col-sm-8">
                    @Model.HoraFim.ToString("HH\\:mm")
                </dd>

                <dt class="col-sm-4 fw-semibold text-secondary">Data de Cancelamento</dt>
                <dd class="col-sm-8">
                    @(Model.DataCancelamento.HasValue
                                        ? Model.DataCancelamento.Value.ToString("dd/MM/yyyy HH:mm")
                                        : "—")
                </dd>

                <dt class="col-sm-4 fw-semibold text-secondary">Estado da Consulta</dt>
                <dd class="col-sm-8">
                    @Model.Estado
                </dd>

                <!-- ✅ NOVO: Médico -->
                <dt class="col-sm-4 fw-semibold text-secondary">Médico:</dt>
                <dd class="col-sm-8">
                    @(Model.Doctor != null ? Model.Doctor.Nome : "—")
                </dd>

                <!-- ✅ NOVO: Especialidade -->
                <dt class="col-sm-4 fw-semibold text-secondary">Especialidade:</dt>
                <dd class="col-sm-8">
                    @(Model.Speciality != null ? Model.Speciality.Nome : "—")
                </dd>

                <!-- ✅ NOVO: Utente (Email) -->
                <dt class="col-sm-4 fw-semibold text-secondary">Email do Utente</dt>
                <dd class="col-sm-8">
                    @(Model.UtenteSaude?.Client?.Email ?? "—")
                </dd>
            </dl>

            <hr class="my-4" />
            <hr />

            <h4 class="mt-3">Observações</h4>

            @if (string.IsNullOrWhiteSpace(Model.Observacoes))
            {
                <p class="text-muted">Sem observações.</p>
            }
            else
            {
                <div class="border rounded p-3 bg-light" style="white-space: pre-wrap;">
                    @Model.Observacoes
                </div>
            }

            <a asp-action="Observacoes" asp-route-id="@Model.IdConsulta" class="btn btn-secondary mt-3">
                <i class="bi bi-journal-text"></i> Editar Observações
            </a>

            <div class="d-flex justify-content-between">
                <a asp-action="Index" class="btn btn-outline-secondary px-4">
                    <i class="bi bi-arrow-left"></i> Voltar
                </a>
            </div>
        </div>
    </div>
</div>

@section Scripts {
    <!-- sem scripts obrigatórios aqui -->
}
