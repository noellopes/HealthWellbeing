@model HealthWellbeing.Models.Exercicio
@using HealthWellbeing.Models

@{
    ViewData["Title"] = "Criar Exercício";
}

<h1>@ViewData["Title"]</h1>

@if (TempData["ErrorMessage"] != null)
{
    <div class="alert alert-danger">
        @TempData["ErrorMessage"]
    </div>
}

<form asp-action="Create" method="post">
    @Html.AntiForgeryToken()
    <div asp-validation-summary="All" class="text-danger"></div>

    <div class="mb-3">
        <label asp-for="ExercicioNome" class="form-label">Nome do Exercício *</label>
        <input asp-for="ExercicioNome" class="form-control" placeholder="Ex: Flexões, Corrida, Agachamentos">
        <span asp-validation-for="ExercicioNome" class="text-danger small"></span>
    </div>

    <div class="mb-3">
        <label asp-for="Descricao" class="form-label">Descrição *</label>
        <textarea asp-for="Descricao" class="form-control" rows="3" placeholder="Descreva o exercício..."></textarea>
        <span asp-validation-for="Descricao" class="text-danger small"></span>
    </div>

    <hr class="my-4" />

    <div class="form-group mb-4">
        <label class="control-label fw-bold">Tipo de Exercício *</label>
        <div class="border p-3 rounded mt-2">
            @if (ViewBag.TiposExercicios != null && ((IEnumerable<TipoExercicio>)ViewBag.TiposExercicios).Any())
            {
                <div class="row">
                    @foreach (var item in (IEnumerable<TipoExercicio>)ViewBag.TiposExercicios)
                    {
                        <div class="col-md-4 mb-2">
                            <div class="form-check">
                                <input class="form-check-input" type="checkbox"
                                       name="tipoExerciciosIds"
                                       value="@item.TipoExercicioId"
                                       id="type_@item.TipoExercicioId" />

                                <label class="form-check-label" for="type_@item.TipoExercicioId">
                                    @item.NomeTipoExercicios
                                </label>
                            </div>
                        </div>
                    }
                </div>
            }
            else
            {
                <div class="alert alert-warning">Nenhum tipo de exercício registado.</div>
            }
        </div>
    </div>

    <div class="form-group mb-4">
        <label class="control-label fw-bold">Objetivos Físicos</label>
        <div class="border p-3 rounded mt-2">
            @if (ViewBag.ObjetivosFisicos != null && ((IEnumerable<ObjetivoFisico>)ViewBag.ObjetivosFisicos).Any())
            {
                <div class="row">
                    @foreach (var item in (IEnumerable<ObjetivoFisico>)ViewBag.ObjetivosFisicos)
                    {
                        <div class="col-md-4 mb-2">
                            <div class="form-check">
                                <input class="form-check-input" type="checkbox"
                                       name="objetivosFisicosIds"
                                       value="@item.ObjetivoFisicoId"
                                       id="goal_@item.ObjetivoFisicoId" />

                                <label class="form-check-label" for="goal_@item.ObjetivoFisicoId">
                                    @item.NomeObjetivo
                                </label>
                            </div>
                        </div>
                    }
                </div>
            }
            else
            {
                <div class="alert alert-warning">Nenhum objetivo registado.</div>
            }
        </div>
    </div>

    <hr class="my-4" />

    <div class="form-group mb-4">
        <label class="control-label fw-bold">Equipamentos Necessários</label>
        <div class="border p-3 rounded mt-2">
            @if (ViewBag.Equipamentos != null && ((IEnumerable<SelectListItem>)ViewBag.Equipamentos).Any())
            {
                <div class="row">
                    @foreach (var item in (IEnumerable<SelectListItem>)ViewBag.Equipamentos)
                    {
                        <div class="col-md-4 mb-2">
                            <div class="form-check">
                                <input class="form-check-input" type="checkbox"
                                       name="equipamentosIds"
                                       value="@item.Value"
                                       id="eq_@item.Value" />
                                <label class="form-check-label" for="eq_@item.Value">
                                    @item.Text
                                </label>
                            </div>
                        </div>
                    }
                </div>
            }
            else
            {
                <div class="alert alert-warning">Nenhum equipamento encontrado.</div>
            }
        </div>
    </div>

    <div class="form-group mb-4">
        <label class="control-label fw-bold">Grupos Musculares Associados</label>
        <div class="border p-3 rounded mt-2">
            @if (ViewBag.GruposMusculares != null && ((IEnumerable<SelectListItem>)ViewBag.GruposMusculares).Any())
            {
                <div class="row">
                    @foreach (var grupoMuscular in (IEnumerable<SelectListItem>)ViewBag.GruposMusculares)
                    {
                        <div class="col-md-6 mb-2">
                            <div class="form-check">
                                <input class="form-check-input" type="checkbox"
                                       name="GrupoMuscularIds"
                                       value="@grupoMuscular.Value"
                                       id="musculo_@grupoMuscular.Value" />

                                @* Nota: O name="GrupoMuscularIds" deve bater certo com o controller *@

                                <label class="form-check-label" for="musculo_@grupoMuscular.Value">
                                    @grupoMuscular.Text
                                </label>
                            </div>
                        </div>
                    }
                </div>
            }
            else
            {
                <div class="alert alert-warning">Nenhum grupo muscular encontrado.</div>
            }
        </div>
    </div>

    <div class="form-group mb-4">
        <label class="control-label fw-bold">Gêneros Associados</label>
        <div class="border p-3 rounded mt-2">
            @if (ViewBag.Generos != null && ((IEnumerable<SelectListItem>)ViewBag.Generos).Any())
            {
                <div class="row">
                    @foreach (var genero in (IEnumerable<SelectListItem>)ViewBag.Generos)
                    {
                        <div class="col-md-6 mb-2">
                            <div class="form-check">
                                <input class="form-check-input" type="checkbox"
                                       name="generosIds"
                                       value="@genero.Value"
                                       id="genero_@genero.Value" />
                                <label class="form-check-label" for="genero_@genero.Value">
                                    @genero.Text
                                </label>
                            </div>
                        </div>
                    }
                </div>
            }
            else
            {
                <div class="alert alert-warning">Nenhum gênero encontrado.</div>
            }
        </div>
    </div>

    <div class="form-group mb-4">
        <label class="control-label fw-bold text-danger">Contraindicações</label>
        <div class="border p-3 rounded mt-2 bg-light">
            @if (ViewBag.Contraindicacoes != null && ((IEnumerable<SelectListItem>)ViewBag.Contraindicacoes).Any())
            {
                <div class="row">
                    @foreach (var problema in (IEnumerable<SelectListItem>)ViewBag.Contraindicacoes)
                    {
                        <div class="col-md-6 mb-2">
                            <div class="form-check">
                                <input class="form-check-input" type="checkbox"
                                       name="problemasSaudeIds"
                                       value="@problema.Value"
                                       id="problema_@problema.Value" />
                                <label class="form-check-label" for="problema_@problema.Value">
                                    @problema.Text
                                </label>
                            </div>
                        </div>
                    }
                </div>
            }
            else
            {
                <div class="alert alert-warning">Nenhum problema de saúde registado.</div>
            }
        </div>
    </div>

    <hr class="my-4" />

    <div class="row">
        <div class="col-md-4 mb-3">
            <label asp-for="Duracao" class="form-label">Duração (minutos) *</label>
            <input asp-for="Duracao" type="number" step="0.1" class="form-control">
            <span asp-validation-for="Duracao" class="text-danger small"></span>
        </div>

        <div class="col-md-4 mb-3">
            <label asp-for="Intencidade" class="form-label">Intensidade (1-10) *</label>
            <input asp-for="Intencidade" type="number" class="form-control">
            <span asp-validation-for="Intencidade" class="text-danger small"></span>
        </div>

        <div class="col-md-4 mb-3">
            <label asp-for="CaloriasGastas" class="form-label">Calorias Gastas *</label>
            <input asp-for="CaloriasGastas" type="number" step="0.1" class="form-control">
            <span asp-validation-for="CaloriasGastas" class="text-danger small"></span>
        </div>
    </div>

    <div class="row">
        <div class="col-md-6 mb-3">
            <label asp-for="Repeticoes" class="form-label">Repetições *</label>
            <input asp-for="Repeticoes" type="number" class="form-control">
            <span asp-validation-for="Repeticoes" class="text-danger small"></span>
        </div>

        <div class="col-md-6 mb-3">
            <label asp-for="Series" class="form-label">Séries *</label>
            <input asp-for="Series" type="number" class="form-control">
            <span asp-validation-for="Series" class="text-danger small"></span>
        </div>
    </div>

    <div class="mb-3">
        <label asp-for="Instrucoes" class="form-label">Instruções *</label>
        <textarea asp-for="Instrucoes" class="form-control" rows="3"></textarea>
        <span asp-validation-for="Instrucoes" class="text-danger small"></span>
    </div>

    <div class="mt-4">
        <button type="submit" class="btn btn-success">
            <i class="fas fa-save"></i> Criar Exercício
        </button>
        <a asp-action="Index" class="btn btn-secondary">
            <i class="fas fa-arrow-left"></i> Voltar à Lista
        </a>
    </div>

</form>

@section Scripts {
    @{
        await Html.RenderPartialAsync("_ValidationScriptsPartial");
    }
}