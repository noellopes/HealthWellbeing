@model IEnumerable<HealthWellbeingRoom.Models.RoomReservationHistory>

@{
    ViewData["Title"] = "Histórico da Sala";
    var roomName = Model.FirstOrDefault()?.Room?.Name ?? "Sala";
}

<h1 class="mb-4 text-success">
    <i class="bi bi-clock-history"></i> Histórico de reservas — @roomName
</h1>

<div class="card shadow-sm" style="min-height: 60vh;">
    <div class="card-body">

        <table class="table table-striped table-hover align-middle mb-0">
            <thead class="table-light">
                <tr>
                    @* <th>Id</th> *@
                    <th>Início</th>
                    <th>Fim</th>
                    <th>Responsável</th>
                    <th>Estado Final</th>
                    <th>Registado em</th>
                </tr>
            </thead>

            <tbody>
                @if (!Model.Any())
                {
                    <tr>
                        <td colspan="6" class="text-center text-muted py-4">
                            <i class="bi bi-info-circle"></i> Ainda não existem registos de histórico para esta sala.
                        </td>
                    </tr>
                }
                else
                {
                    @foreach (var item in Model)
                    {
                        var cssClass = item.FinalStatus == "Realizada"
                        ? "table-success"
                        : item.FinalStatus == "Cancelada"
                        ? "table-danger"
                        : "";

                        <tr class="@cssClass">
                            @* <td>@item.ConsultationId.ToString("D3")</td> *@
                            <td>@item.ConsultationDate.ToString("dd/MM/yyyy") @item.StartHour.ToString(@"hh\:mm")</td>
                            <td>@item.ConsultationDate.ToString("dd/MM/yyyy") @item.EndHour.ToString(@"hh\:mm")</td>
                            <td>@item.ResponsibleName</td>
                            <td>@item.FinalStatus</td>
                            <td>@item.RecordedAt.ToString("dd/MM/yyyy HH:mm")</td>
                        </tr>
                    }
                }
            </tbody>
        </table>

    </div>
</div>

<!-- Botões fora da card, alinhados com a largura da tabela -->
<div class="mt-4 d-flex justify-content-between">

    <!-- Botão Lista de Salas (Home) -->
    <a asp-controller="Rooms"
       asp-action="Index"
       class="btn btn-primary btn-sm">
        <i class="bi bi-house-door-fill me-1"></i> Lista de Salas
    </a>

    <!-- Botão Voltar à Sala -->
    <a asp-controller="Rooms"
       asp-action="Details"
       asp-route-id="@ViewBag.RoomId"
       class="btn btn-primary btn-sm">
        <i class="bi bi-arrow-left-circle me-1"></i> Voltar à Sala
    </a>

</div>