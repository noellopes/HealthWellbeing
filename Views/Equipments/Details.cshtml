@model HealthWellbeingRoom.Models.Equipment

@{
    ViewData["Title"] = "Detalhes";
    string? successMessage = Context.Request.Query["SuccessMessage"];

    // --- Verificar permissões ---
    bool isAdmin = User.IsInRole("Administrator");
}

@if (successMessage != null)
{
    <div class="container py-4">
        <div class="alert alert-success alert-dismissible fade show" role="alert">
            <i class="bi bi-check-circle-fill me-2"></i>
            @successMessage
            <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
        </div>
    </div>
}

<h1 class="mb-4">@ViewData["Title"]</h1>

<div class="card shadow-sm">
    <div class="card-header bg-info text-black">
        <h4 class="mb-0">
            <i class="bi bi-gear me-2"></i> Informações do Equipamento
        </h4>
    </div>

    <div class="card-body">
        <dl class="row">
            <dt class="col-sm-3 fw-bold text-muted">
                Nome
            </dt>
            <dd class="col-sm-9">
                @Html.DisplayFor(model => model.Name)
            </dd>

            <dt class="col-sm-3 fw-bold text-muted">
                Sala
            </dt>
            <dd class="col-sm-9">
                @Html.DisplayFor(model => model.Room.Name)
            </dd>

            <dt class="col-sm-3 fw-bold text-muted">
                Tipo de Equipamento
            </dt>
            <dd class="col-sm-9">
                @Html.DisplayFor(model => model.EquipmentType.Name)
            </dd>

            <dt class="col-sm-3 fw-bold text-muted">
                Estado
            </dt>
            <dd class="col-sm-9">
                <span class="badge bg-@(Model.EquipmentStatusId == 1 ? "success" : Model.EquipmentStatusId == 2 ? "warning" : "danger")">
                    @Html.DisplayFor(model => model.EquipmentStatus.Name)
                </span>
            </dd>
            
            <dt class="col-sm-3 fw-bold text-muted">
                Nº de Série
            </dt>
            <dd class="col-sm-9">
                @Html.DisplayFor(model => model.SerialNumber)
            </dd>

            <dt class="col-sm-3 fw-bold text-muted">
                Data compra
            </dt>
            <dd class="col-sm-9">
                @Html.DisplayFor(model => model.PurchaseDate)
            </dd>

            <dt class="col-sm-3 fw-bold text-muted">
                Descrição
            </dt>
            <dd class="col-sm-9">
                @Html.DisplayFor(model => model.Description)
            </dd>
        </dl>
    </div>
</div>

<div class="mt-4 d-flex justify-content-end gap-2">
@*     Voltar a pagina anterior de equipamentos associados*@
    @if (ViewBag.Origem == "dispositivosAssociados")
    {
        <a asp-controller="Rooms"
           asp-action="Equipments"
           asp-route-id="@ViewBag.RoomId"
           class="btn btn-outline-primary">
            <i class="bi bi-arrow-left-circle me-1"></i> Voltar a lista de equipamentos associados
        </a>
    }
    @if (Model.EquipmentStatus.Name != "Excluído")
    {
        <a class="btn btn-warning me-1" asp-action="Edit" asp-route-id="@Model?.EquipmentId">
            <i class="bi bi-pencil-square"></i> Editar
        </a>

        @if (isAdmin)
        {
            <a asp-action="Delete" asp-route-id="@Model?.EquipmentId" class="btn btn-danger">
                <i class="bi bi-trash"></i> Eliminar
            </a>
        }
    }

    <a class="btn btn-secondary" asp-action="Index">
        <i class="bi bi-arrow-left-circle me-1"></i> Voltar a Lista
    </a>
</div>
